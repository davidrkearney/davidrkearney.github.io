
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Predicting Onset/Diagnosis of Chronic Conditions, Diabetes &#8212; Hands On Data Science at Scale with PySpark, Dask and H2O.</title>
    
  <link rel="stylesheet" href="_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Hands On Data Science at Scale with PySpark, Dask and H2O." href="intro.html" />
    <link rel="prev" title="Using sqlalchemy and pandas to read and write from and to a local sqlite database for NLP" href="2020-10-06-NLP-sqlitedb.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  <img src="_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Hands On Data Science at Scale with PySpark, Dask and H2O.</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="2020-10-25-ARIMA-ADF-FORECASTING.html">
   Stock Market Analysis of the S&amp;P 500 Index using ARIMA and Seasonal ARIMA for forecasting
  </a>
 </li>
</ul>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="2020-08-17-Pyspark-Group-By.html">
   Group By and Aggregation with Pyspark
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2020-08-22-Window%20functions%20and%20Pivot%20Tables%20with%20Pyspark.html">
   Window functions and Pivot Tables with Pyspark
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2020-08-29-Clustering%20with%20Pyspark.html">
   Clustering with Pyspark
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2020-10-27-sql_calls_in_jupyter_Soccer_Pred.html">
   Working with sqlite databases in Jupyter for Visualizing European Soccer Match Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2020-10-19-ttests-distributions-crosstabs-functions.html">
   Evaluating Distributions and generating Experimental Crosstabs for the Evaluation of Experiments as well as Experimental Comparisons with T-Tests, Purpose Assumptions, Corrections and Implementations in Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2020-09-24-AnalyzingUSRealInterestRate.html">
   Analyzing US Real Interest Rate From 1959 - 2009 with statsmodels
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2020-08-30-NLP%20with%20Pyspark.html">
   NLP with Pyspark
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2020-08-19-Pyspark-Filtering.html">
   Dataframe Filitering and Operations with Pyspark
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2020-10-28-PCA-with-sklearn.html">
   Principal component analysis with sklearn
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2020-11-20-Dask-Diab.html">
   Dask for Predicting Onset/Diagnosis of Chronic Conditions, Diabetes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2020-10-17-dask-NLP-gutenberg-books.html">
   Using Dask with dask.bag and regex to parse Notes from the Underground from project gutenberg
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2020-10-17-dask-NLP-gutenberg-books.html#removing-stop-words-in-top-word-frequency-counts">
   Removing stop words in top word frequency counts
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2020-09-30-StockMarketPortfolioAnaylsis_snp.html">
   Stock Market and Portfolio Anaylsis of the S&amp;P 500 with pandas and quandl
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2020-10-10-Dask_Fiscal-db-to-dask-dataframe.html">
   Working with dask data frames. Reading Fiscal Data from a sqlite db to a dask dataframe. Computing, visualizing and groupby with dask dataframes. Using dask.distributed locally.
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2020-08-20-Pyspark-Dataframes-Data-Types.html">
   Dataframes, Formatting, Casting Data Type and Correlation with Pyspark
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2020-10-13-dask-xgboost-fiscal-data.html">
   Moving Dask XGboost with Fiscal Data, saving and loading Dask XGboost models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2020-10-12-dask-xgboost-fiscal-data..html">
   Visualizing Operations with Dask Dataframes on Fiscal Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2020-10-01-StockMarketPortfolioAnaylsis_snp%2B.html">
   Stock Market and Portfolio Anaylsis of the S&amp;P 500 various metrics with pandas and quandl
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2020-08-25-Linear%20Regression%20and%20Random%20Forest_GBT%20Classification%20with%20Pyspark.html">
   Regression and Classification with Pyspark ML
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2020-08-16-pandas-stats-fiscal.html">
   Using Pandas and Statsmodels for Regression with Fiscal Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2020-09-21-StockMarketPortfolioAnaylsis2.html">
   Stock Market and Optimal Portfolio Anaylsis scipy and quandl
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2020-08-18-Pyspark-NAs.html">
   Handling Missing Data with Pyspark
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2020-10-29-pyquery_for_ebooks_python.html">
   Creating E-Books (.epub) in python using ebooklib
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2020-11-09-dask-sql.html">
   Using Dask and dask-sql
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2020-08-15-Pyspark-Fiscal-Data-Regression.html">
   Pyspark Regression with Fiscal Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2020-09-02-NLP_Ngram.html">
   NLP ngrams With Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2020-08-22-Linear%20Regression%20and%20Random%20Forest_GBT%20Classification%20with%20Pyspark.html">
   Regression and Classification with Pyspark ML
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2020-11-16-automl-capabilities-of-h2o-library.html">
   AutoML, Xgboost and H2O
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2020-10-21-quant_data_datareader_quandl.html">
   Using the Quandl API and Pandas Datareader API to call Microsoft, Apple, Zoom, Snowflake stocks and other finance data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2020-10-12-dask-xgboost-fiscal-data.html">
   Visualizing Operations with Dask Dataframes on Fiscal Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="bibliography.html">
   Bibliography for Hands On Data Science at Scale with PySpark, Dask and H2O.
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="building_book.html">
   Creating the book:
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2020-11-10-Dask-api-eda.html">
   Dask API for analytics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2020-10-31-sql_calls_in_jupyter_Soccer_explore.html">
   Working with sqlite databases in Jupyter for Visualizing European Soccer Match Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2020-10-14-dask-xgboost-HT-OHE.html">
   Using dask_ml.preprocessing and OneHotEncoder for categorical encoding with Dask
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2020-10-05-StockMarketPortfolioAnaylsis_snp_pandas_datareader_sqlite-Copy1.html">
   Using sqlalchemy and pandas to read and write from and to a local sqlite database for Stock Market and Portfolio Anaylsis Tech Stocks and the S&amp;P 500 in 2020
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="toc.html">
   Table of Contents for Data Science at Scale
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2020-10-09-Dask_Fiscal-Data-Sqlite-db.html">
   Moving fiscal data from a pandas dataframe to a sqlite local database
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2020-10-04-StockMarketPortfolioAnaylsis_snp_pandas_datareader_sqlite-Copy1.html">
   Stock Market and Portfolio Anaylsis Tech Stocks and the S&amp;P 500 in 2020 with pandas_datareader and writing to at sqlite database
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2020-10-22-stock-market-returns.html">
   Stock Market Analysis of Microsoft, Zoom, and Snowflake
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2020-09-25-AnalyzingSizeofArmedForces.html">
   Analyzing Size of Armed Forces From 1947 - 1963 with statsmodels
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2020-10-30-Function-for-zillow-data-quandl-api.html">
   Using quandl zillow api for Chicago and Evanston Home Sale Prices using ARIMA and EWMAs
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2020-10-18-ttests-distributions-crosstabs.html">
   Evaluating Distributions and generating experimental Crosstabs for the evaluation of Experiments
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2020-10-11-dask-xgboost-fiscal-data.html">
   Moving Fiscal Data from a sqlite db to a dask dataframe
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2020-09-22-AnalyzingUSUnemployment.html">
   Analyzing US Unemployment From 1959 - 2009 with statsmodels
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2020-09-19-StockMarketPortfolioAnaylsis.html">
   Stock Market and Portfolio Anaylsis with pandas_datareader and quandl
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2020-09-23-AnalyzingUSInflation.html">
   Analyzing US Inflation From 1959 - 2009 with statsmodels
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2020-09-28-databases_sqllite_sqlalchemy_27.html">
   Creating and accessing SQL databases with python using sqlalchemy and sqlite3
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="setup.html">
   Setting Up Computing Enviroment
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2020-10-07-Fiscal_data-sqlitedb-Copy1.html">
   Using sqlalchemy and pandas to read and write from and to a local sqlite database for Fiscal Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2020-10-06-NLP-sqlitedb.html">
   Using sqlalchemy and pandas to read and write from and to a local sqlite database for NLP
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Predicting Onset/Diagnosis of Chronic Conditions, Diabetes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="#national-institute-of-diabetes-and-digestive-and-kidney-diseases-https-www-niddk-nih-gov">
   National Institute of Diabetes and Digestive and Kidney Diseases, https://www.niddk.nih.gov/
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Hands On Data Science at Scale with PySpark, Dask and H2O.
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2020-10-26-Working_with_sqlite3_dbs_in_jupyter_Soccer_Pred.html">
   Working with sqlite databases in Jupyter for European Soccer Match Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2020-10-16-dask-NLP-gutenberg-books.html">
   Using Dask with dask.bag and regex to parse The Brothers Karamazov from project gutenberg
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2020-10-16-dask-NLP-gutenberg-books.html#removing-stop-words-in-top-word-frequency-counts">
   Removing stop words in top word frequency counts
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2020-10-02-databases_sqllite_sqlalchemy_27-Copy1.html">
   Creating and accessing SQL databases with python using sqlalchemy and sqlite
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="git_setup.html">
   Setting up Version Control/Git Configuration:
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2020-10-15-dask-xgboost-Linear-Regresion-Copy1.html">
   Linear Regression using Dask Data Frames
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2020-10-08-Dask-Day-1.html">
   Using Dask for Arrays
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2020-09-03-NLP_Seaborn_Heatmaps.html">
   NLP Heatmaps with Seaborn
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2020-08-21-RDDs%20and%20Schemas%20and%20Data%20Types%20with%20Pyspark.html">
   RDDs and Schemas and Data Types with Pyspark
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/2020-11-17-diab_prediction_with_h2o.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/2020-11-17-diab_prediction_with_h2o.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Predicting Onset/Diagnosis of Chronic Conditions, Diabetes
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#national-institute-of-diabetes-and-digestive-and-kidney-diseases-https-www-niddk-nih-gov">
   National Institute of Diabetes and Digestive and Kidney Diseases, https://www.niddk.nih.gov/
  </a>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="predicting-onset-diagnosis-of-chronic-conditions-diabetes">
<h1>Predicting Onset/Diagnosis of Chronic Conditions, Diabetes<a class="headerlink" href="#predicting-onset-diagnosis-of-chronic-conditions-diabetes" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p>toc: true</p></li>
<li><p>badges: true</p></li>
<li><p>comments: true</p></li>
<li><p>sticky_rank: 1</p></li>
<li><p>categories: [Big Data , h2o]</p></li>
</ul>
</div>
<div class="section" id="national-institute-of-diabetes-and-digestive-and-kidney-diseases-https-www-niddk-nih-gov">
<h1>National Institute of Diabetes and Digestive and Kidney Diseases, https://www.niddk.nih.gov/<a class="headerlink" href="#national-institute-of-diabetes-and-digestive-and-kidney-diseases-https-www-niddk-nih-gov" title="Permalink to this headline">¶</a></h1>
<p><img alt="h2o.ai" src="https://avatars0.githubusercontent.com/u/1402695?s=200&amp;v=4" /></p>
<p>Credit: code from https://www.kaggle.com/sudalairajkumar/getting-started-with-h2o</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">h2o</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">seaborn</span>
<span class="kn">import</span> <span class="nn">itertools</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">h2o.estimators.glm</span> <span class="kn">import</span> <span class="n">H2OGeneralizedLinearEstimator</span>
<span class="kn">from</span> <span class="nn">h2o.estimators.gbm</span> <span class="kn">import</span> <span class="n">H2OGradientBoostingEstimator</span>
<span class="kn">from</span> <span class="nn">h2o.estimators.random_forest</span> <span class="kn">import</span> <span class="n">H2ORandomForestEstimator</span>

<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">h2o</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Checking whether there is an H2O instance running at http://localhost:54321 . connected.
</pre></div>
</div>
<div class="output text_html"><div style="overflow:auto"><table style="width:50%"><tr><td>H2O_cluster_uptime:</td>
<td>9 mins 06 secs</td></tr>
<tr><td>H2O_cluster_timezone:</td>
<td>Etc/UTC</td></tr>
<tr><td>H2O_data_parsing_timezone:</td>
<td>UTC</td></tr>
<tr><td>H2O_cluster_version:</td>
<td>3.30.1.3</td></tr>
<tr><td>H2O_cluster_version_age:</td>
<td>1 month and 10 days </td></tr>
<tr><td>H2O_cluster_name:</td>
<td>H2O_from_python_unknownUser_6cf4p5</td></tr>
<tr><td>H2O_cluster_total_nodes:</td>
<td>1</td></tr>
<tr><td>H2O_cluster_free_memory:</td>
<td>3.179 Gb</td></tr>
<tr><td>H2O_cluster_total_cores:</td>
<td>2</td></tr>
<tr><td>H2O_cluster_allowed_cores:</td>
<td>2</td></tr>
<tr><td>H2O_cluster_status:</td>
<td>locked, healthy</td></tr>
<tr><td>H2O_connection_url:</td>
<td>http://localhost:54321</td></tr>
<tr><td>H2O_connection_proxy:</td>
<td>{"http": null, "https": null}</td></tr>
<tr><td>H2O_internal_security:</td>
<td>False</td></tr>
<tr><td>H2O_API_Extensions:</td>
<td>Amazon S3, XGBoost, Algos, AutoML, Core V3, TargetEncoder, Core V4</td></tr>
<tr><td>Python_version:</td>
<td>3.6.9 final</td></tr></table></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">diabetes_df</span> <span class="o">=</span> <span class="n">h2o</span><span class="o">.</span><span class="n">import_file</span><span class="p">(</span><span class="s2">&quot;https://raw.githubusercontent.com/davidrkearney/colab-notebooks/main/datasets/diabetes.csv&quot;</span><span class="p">,</span> <span class="n">destination_frame</span><span class="o">=</span><span class="s2">&quot;diabetes_df&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Parse progress: |█████████████████████████████████████████████████████████| 100%
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://raw.githubusercontent.com/davidrkearney/colab-notebooks/main/datasets/diabetes.csv&#39;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">error_bad_lines</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Pregnancies</th>
      <th>Glucose</th>
      <th>BloodPressure</th>
      <th>SkinThickness</th>
      <th>Insulin</th>
      <th>BMI</th>
      <th>DiabetesPedigreeFunction</th>
      <th>Age</th>
      <th>Outcome</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>6</td>
      <td>148</td>
      <td>72</td>
      <td>35</td>
      <td>0</td>
      <td>33.6</td>
      <td>0.627</td>
      <td>50</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>85</td>
      <td>66</td>
      <td>29</td>
      <td>0</td>
      <td>26.6</td>
      <td>0.351</td>
      <td>31</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>8</td>
      <td>183</td>
      <td>64</td>
      <td>0</td>
      <td>0</td>
      <td>23.3</td>
      <td>0.672</td>
      <td>32</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>89</td>
      <td>66</td>
      <td>23</td>
      <td>94</td>
      <td>28.1</td>
      <td>0.167</td>
      <td>21</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>137</td>
      <td>40</td>
      <td>35</td>
      <td>168</td>
      <td>43.1</td>
      <td>2.288</td>
      <td>33</td>
      <td>1</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>763</th>
      <td>10</td>
      <td>101</td>
      <td>76</td>
      <td>48</td>
      <td>180</td>
      <td>32.9</td>
      <td>0.171</td>
      <td>63</td>
      <td>0</td>
    </tr>
    <tr>
      <th>764</th>
      <td>2</td>
      <td>122</td>
      <td>70</td>
      <td>27</td>
      <td>0</td>
      <td>36.8</td>
      <td>0.340</td>
      <td>27</td>
      <td>0</td>
    </tr>
    <tr>
      <th>765</th>
      <td>5</td>
      <td>121</td>
      <td>72</td>
      <td>23</td>
      <td>112</td>
      <td>26.2</td>
      <td>0.245</td>
      <td>30</td>
      <td>0</td>
    </tr>
    <tr>
      <th>766</th>
      <td>1</td>
      <td>126</td>
      <td>60</td>
      <td>0</td>
      <td>0</td>
      <td>30.1</td>
      <td>0.349</td>
      <td>47</td>
      <td>1</td>
    </tr>
    <tr>
      <th>767</th>
      <td>1</td>
      <td>93</td>
      <td>70</td>
      <td>31</td>
      <td>0</td>
      <td>30.4</td>
      <td>0.315</td>
      <td>23</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>768 rows × 9 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">diabetes_df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Rows:768
Cols:9
</pre></div>
</div>
<div class="output text_html"><table>
<thead>
<tr><th>       </th><th>Pregnancies      </th><th>Glucose           </th><th>BloodPressure     </th><th>SkinThickness     </th><th>Insulin           </th><th>BMI              </th><th>DiabetesPedigreeFunction  </th><th>Age               </th><th>Outcome            </th></tr>
</thead>
<tbody>
<tr><td>type   </td><td>int              </td><td>int               </td><td>int               </td><td>int               </td><td>int               </td><td>real             </td><td>real                      </td><td>int               </td><td>int                </td></tr>
<tr><td>mins   </td><td>0.0              </td><td>0.0               </td><td>0.0               </td><td>0.0               </td><td>0.0               </td><td>0.0              </td><td>0.078                     </td><td>21.0              </td><td>0.0                </td></tr>
<tr><td>mean   </td><td>3.845052083333336</td><td>120.89453125      </td><td>69.10546874999994 </td><td>20.536458333333357</td><td>79.79947916666666 </td><td>31.99257812500003</td><td>0.4718763020833334        </td><td>33.240885416666615</td><td>0.3489583333333333 </td></tr>
<tr><td>maxs   </td><td>17.0             </td><td>199.0             </td><td>122.0             </td><td>99.0              </td><td>846.0             </td><td>67.1             </td><td>2.42                      </td><td>81.0              </td><td>1.0                </td></tr>
<tr><td>sigma  </td><td>3.36957806269887 </td><td>31.972618195136224</td><td>19.355807170644777</td><td>15.952217567727642</td><td>115.24400235133803</td><td>7.884160320375441</td><td>0.331328595012775         </td><td>11.760231540678689</td><td>0.47695137724279896</td></tr>
<tr><td>zeros  </td><td>111              </td><td>5                 </td><td>35                </td><td>227               </td><td>374               </td><td>11               </td><td>0                         </td><td>0                 </td><td>500                </td></tr>
<tr><td>missing</td><td>0                </td><td>0                 </td><td>0                 </td><td>0                 </td><td>0                 </td><td>0                </td><td>0                         </td><td>0                 </td><td>0                  </td></tr>
<tr><td>0      </td><td>6.0              </td><td>148.0             </td><td>72.0              </td><td>35.0              </td><td>0.0               </td><td>33.6             </td><td>0.627                     </td><td>50.0              </td><td>1.0                </td></tr>
<tr><td>1      </td><td>1.0              </td><td>85.0              </td><td>66.0              </td><td>29.0              </td><td>0.0               </td><td>26.6             </td><td>0.351                     </td><td>31.0              </td><td>0.0                </td></tr>
<tr><td>2      </td><td>8.0              </td><td>183.0             </td><td>64.0              </td><td>0.0               </td><td>0.0               </td><td>23.3             </td><td>0.672                     </td><td>32.0              </td><td>1.0                </td></tr>
<tr><td>3      </td><td>1.0              </td><td>89.0              </td><td>66.0              </td><td>23.0              </td><td>94.0              </td><td>28.1             </td><td>0.167                     </td><td>21.0              </td><td>0.0                </td></tr>
<tr><td>4      </td><td>0.0              </td><td>137.0             </td><td>40.0              </td><td>35.0              </td><td>168.0             </td><td>43.1             </td><td>2.288                     </td><td>33.0              </td><td>1.0                </td></tr>
<tr><td>5      </td><td>5.0              </td><td>116.0             </td><td>74.0              </td><td>0.0               </td><td>0.0               </td><td>25.6             </td><td>0.201                     </td><td>30.0              </td><td>0.0                </td></tr>
<tr><td>6      </td><td>3.0              </td><td>78.0              </td><td>50.0              </td><td>32.0              </td><td>88.0              </td><td>31.0             </td><td>0.248                     </td><td>26.0              </td><td>1.0                </td></tr>
<tr><td>7      </td><td>10.0             </td><td>115.0             </td><td>0.0               </td><td>0.0               </td><td>0.0               </td><td>35.3             </td><td>0.134                     </td><td>29.0              </td><td>0.0                </td></tr>
<tr><td>8      </td><td>2.0              </td><td>197.0             </td><td>70.0              </td><td>45.0              </td><td>543.0             </td><td>30.5             </td><td>0.158                     </td><td>53.0              </td><td>1.0                </td></tr>
<tr><td>9      </td><td>8.0              </td><td>125.0             </td><td>96.0              </td><td>0.0               </td><td>0.0               </td><td>0.0              </td><td>0.232                     </td><td>54.0              </td><td>1.0                </td></tr>
</tbody>
</table></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">diabetes_df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="n">diabetes_df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/2020-11-17-diab_prediction_with_h2o_10_0.png" src="_images/2020-11-17-diab_prediction_with_h2o_10_0.png" />
<img alt="_images/2020-11-17-diab_prediction_with_h2o_10_1.png" src="_images/2020-11-17-diab_prediction_with_h2o_10_1.png" />
<img alt="_images/2020-11-17-diab_prediction_with_h2o_10_2.png" src="_images/2020-11-17-diab_prediction_with_h2o_10_2.png" />
<img alt="_images/2020-11-17-diab_prediction_with_h2o_10_3.png" src="_images/2020-11-17-diab_prediction_with_h2o_10_3.png" />
<img alt="_images/2020-11-17-diab_prediction_with_h2o_10_4.png" src="_images/2020-11-17-diab_prediction_with_h2o_10_4.png" />
<img alt="_images/2020-11-17-diab_prediction_with_h2o_10_5.png" src="_images/2020-11-17-diab_prediction_with_h2o_10_5.png" />
<img alt="_images/2020-11-17-diab_prediction_with_h2o_10_6.png" src="_images/2020-11-17-diab_prediction_with_h2o_10_6.png" />
<img alt="_images/2020-11-17-diab_prediction_with_h2o_10_7.png" src="_images/2020-11-17-diab_prediction_with_h2o_10_7.png" />
<img alt="_images/2020-11-17-diab_prediction_with_h2o_10_8.png" src="_images/2020-11-17-diab_prediction_with_h2o_10_8.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">corr</span> <span class="o">=</span> <span class="n">diabetes_df</span><span class="o">.</span><span class="n">cor</span><span class="p">()</span><span class="o">.</span><span class="n">as_data_frame</span><span class="p">()</span>
<span class="n">corr</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">diabetes_df</span><span class="o">.</span><span class="n">columns</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">corr</span><span class="p">,</span> <span class="n">annot</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;RdYlGn&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Correlation Heatmap&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/2020-11-17-diab_prediction_with_h2o_11_0.png" src="_images/2020-11-17-diab_prediction_with_h2o_11_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train</span><span class="p">,</span> <span class="n">valid</span><span class="p">,</span> <span class="n">test</span> <span class="o">=</span> <span class="n">diabetes_df</span><span class="o">.</span><span class="n">split_frame</span><span class="p">(</span><span class="n">ratios</span><span class="o">=</span><span class="p">[</span><span class="mf">0.6</span><span class="p">,</span><span class="mf">0.2</span><span class="p">],</span> <span class="n">seed</span><span class="o">=</span><span class="mi">1234</span><span class="p">)</span>
<span class="n">response</span> <span class="o">=</span> <span class="s2">&quot;Outcome&quot;</span>
<span class="n">train</span><span class="p">[</span><span class="n">response</span><span class="p">]</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="n">response</span><span class="p">]</span><span class="o">.</span><span class="n">asfactor</span><span class="p">()</span>
<span class="n">valid</span><span class="p">[</span><span class="n">response</span><span class="p">]</span> <span class="o">=</span> <span class="n">valid</span><span class="p">[</span><span class="n">response</span><span class="p">]</span><span class="o">.</span><span class="n">asfactor</span><span class="p">()</span>
<span class="n">test</span><span class="p">[</span><span class="n">response</span><span class="p">]</span> <span class="o">=</span> <span class="n">test</span><span class="p">[</span><span class="n">response</span><span class="p">]</span><span class="o">.</span><span class="n">asfactor</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of rows in train, valid and test set : &quot;</span><span class="p">,</span> <span class="n">train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">valid</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Number of rows in train, valid and test set :  465 148 155
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">predictors</span> <span class="o">=</span> <span class="n">diabetes_df</span><span class="o">.</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">gbm</span> <span class="o">=</span> <span class="n">H2OGradientBoostingEstimator</span><span class="p">()</span>
<span class="n">gbm</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">predictors</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">response</span><span class="p">,</span> <span class="n">training_frame</span><span class="o">=</span><span class="n">train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>gbm Model Build progress: |███████████████████████████████████████████████| 100%
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">gbm</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Model Details
=============
H2OGradientBoostingEstimator :  Gradient Boosting Machine
Model Key:  GBM_model_python_1604778858031_53


Model Summary: 
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>number_of_trees</th>
      <th>number_of_internal_trees</th>
      <th>model_size_in_bytes</th>
      <th>min_depth</th>
      <th>max_depth</th>
      <th>mean_depth</th>
      <th>min_leaves</th>
      <th>max_leaves</th>
      <th>mean_leaves</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td></td>
      <td>50.0</td>
      <td>50.0</td>
      <td>11552.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>6.0</td>
      <td>23.0</td>
      <td>13.68</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ModelMetricsBinomial: gbm
** Reported on train data. **

MSE: 0.05394537414652564
RMSE: 0.2322614349101582
LogLoss: 0.21164045617145613
Mean Per-Class Error: 0.05419671999032927
AUC: 0.9899262602248459
AUCPR: 0.9845164166436653
Gini: 0.9798525204496917

Confusion Matrix (Act/Pred) for max f1 @ threshold = 0.46220528851885034: 
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>Error</th>
      <th>Rate</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>290.0</td>
      <td>9.0</td>
      <td>0.0301</td>
      <td>(9.0/299.0)</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>14.0</td>
      <td>152.0</td>
      <td>0.0843</td>
      <td>(14.0/166.0)</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Total</td>
      <td>304.0</td>
      <td>161.0</td>
      <td>0.0495</td>
      <td>(23.0/465.0)</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Maximum Metrics: Maximum metrics at their respective thresholds
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>metric</th>
      <th>threshold</th>
      <th>value</th>
      <th>idx</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>max f1</td>
      <td>0.462205</td>
      <td>0.929664</td>
      <td>150.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>max f2</td>
      <td>0.323826</td>
      <td>0.944836</td>
      <td>176.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>max f0point5</td>
      <td>0.548022</td>
      <td>0.967302</td>
      <td>132.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>max accuracy</td>
      <td>0.506976</td>
      <td>0.950538</td>
      <td>142.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>max precision</td>
      <td>0.983850</td>
      <td>1.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>max recall</td>
      <td>0.173383</td>
      <td>1.000000</td>
      <td>227.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>max specificity</td>
      <td>0.983850</td>
      <td>1.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>max absolute_mcc</td>
      <td>0.506976</td>
      <td>0.892066</td>
      <td>142.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>max min_per_class_accuracy</td>
      <td>0.372134</td>
      <td>0.939799</td>
      <td>163.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>max mean_per_class_accuracy</td>
      <td>0.370458</td>
      <td>0.945803</td>
      <td>164.0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>max tns</td>
      <td>0.983850</td>
      <td>299.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>max fns</td>
      <td>0.983850</td>
      <td>165.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>max fps</td>
      <td>0.018713</td>
      <td>299.000000</td>
      <td>399.0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>max tps</td>
      <td>0.173383</td>
      <td>166.000000</td>
      <td>227.0</td>
    </tr>
    <tr>
      <th>14</th>
      <td>max tnr</td>
      <td>0.983850</td>
      <td>1.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>15</th>
      <td>max fnr</td>
      <td>0.983850</td>
      <td>0.993976</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>16</th>
      <td>max fpr</td>
      <td>0.018713</td>
      <td>1.000000</td>
      <td>399.0</td>
    </tr>
    <tr>
      <th>17</th>
      <td>max tpr</td>
      <td>0.173383</td>
      <td>1.000000</td>
      <td>227.0</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Gains/Lift Table: Avg response rate: 35.70 %, avg score: 35.71 %
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>group</th>
      <th>cumulative_data_fraction</th>
      <th>lower_threshold</th>
      <th>lift</th>
      <th>cumulative_lift</th>
      <th>response_rate</th>
      <th>score</th>
      <th>cumulative_response_rate</th>
      <th>cumulative_score</th>
      <th>capture_rate</th>
      <th>cumulative_capture_rate</th>
      <th>gain</th>
      <th>cumulative_gain</th>
      <th>kolmogorov_smirnov</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0.010753</td>
      <td>0.964760</td>
      <td>2.801205</td>
      <td>2.801205</td>
      <td>1.000000</td>
      <td>0.970134</td>
      <td>1.000000</td>
      <td>0.970134</td>
      <td>0.030120</td>
      <td>0.030120</td>
      <td>180.120482</td>
      <td>180.120482</td>
      <td>0.030120</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>0.021505</td>
      <td>0.959842</td>
      <td>2.801205</td>
      <td>2.801205</td>
      <td>1.000000</td>
      <td>0.963441</td>
      <td>1.000000</td>
      <td>0.966788</td>
      <td>0.030120</td>
      <td>0.060241</td>
      <td>180.120482</td>
      <td>180.120482</td>
      <td>0.060241</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>0.030108</td>
      <td>0.948198</td>
      <td>2.801205</td>
      <td>2.801205</td>
      <td>1.000000</td>
      <td>0.952824</td>
      <td>1.000000</td>
      <td>0.962798</td>
      <td>0.024096</td>
      <td>0.084337</td>
      <td>180.120482</td>
      <td>180.120482</td>
      <td>0.084337</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>0.040860</td>
      <td>0.944016</td>
      <td>2.801205</td>
      <td>2.801205</td>
      <td>1.000000</td>
      <td>0.946246</td>
      <td>1.000000</td>
      <td>0.958442</td>
      <td>0.030120</td>
      <td>0.114458</td>
      <td>180.120482</td>
      <td>180.120482</td>
      <td>0.114458</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>0.051613</td>
      <td>0.940243</td>
      <td>2.801205</td>
      <td>2.801205</td>
      <td>1.000000</td>
      <td>0.942268</td>
      <td>1.000000</td>
      <td>0.955073</td>
      <td>0.030120</td>
      <td>0.144578</td>
      <td>180.120482</td>
      <td>180.120482</td>
      <td>0.144578</td>
    </tr>
    <tr>
      <th>5</th>
      <td>6</td>
      <td>0.101075</td>
      <td>0.910936</td>
      <td>2.801205</td>
      <td>2.801205</td>
      <td>1.000000</td>
      <td>0.924669</td>
      <td>1.000000</td>
      <td>0.940194</td>
      <td>0.138554</td>
      <td>0.283133</td>
      <td>180.120482</td>
      <td>180.120482</td>
      <td>0.283133</td>
    </tr>
    <tr>
      <th>6</th>
      <td>7</td>
      <td>0.150538</td>
      <td>0.868553</td>
      <td>2.801205</td>
      <td>2.801205</td>
      <td>1.000000</td>
      <td>0.889815</td>
      <td>1.000000</td>
      <td>0.923641</td>
      <td>0.138554</td>
      <td>0.421687</td>
      <td>180.120482</td>
      <td>180.120482</td>
      <td>0.421687</td>
    </tr>
    <tr>
      <th>7</th>
      <td>8</td>
      <td>0.200000</td>
      <td>0.797054</td>
      <td>2.801205</td>
      <td>2.801205</td>
      <td>1.000000</td>
      <td>0.834641</td>
      <td>1.000000</td>
      <td>0.901630</td>
      <td>0.138554</td>
      <td>0.560241</td>
      <td>180.120482</td>
      <td>180.120482</td>
      <td>0.560241</td>
    </tr>
    <tr>
      <th>8</th>
      <td>9</td>
      <td>0.301075</td>
      <td>0.556327</td>
      <td>2.801205</td>
      <td>2.801205</td>
      <td>1.000000</td>
      <td>0.680179</td>
      <td>1.000000</td>
      <td>0.827286</td>
      <td>0.283133</td>
      <td>0.843373</td>
      <td>180.120482</td>
      <td>180.120482</td>
      <td>0.843373</td>
    </tr>
    <tr>
      <th>9</th>
      <td>10</td>
      <td>0.400000</td>
      <td>0.326087</td>
      <td>1.157019</td>
      <td>2.394578</td>
      <td>0.413043</td>
      <td>0.441848</td>
      <td>0.854839</td>
      <td>0.731963</td>
      <td>0.114458</td>
      <td>0.957831</td>
      <td>15.701938</td>
      <td>139.457831</td>
      <td>0.867530</td>
    </tr>
    <tr>
      <th>10</th>
      <td>11</td>
      <td>0.501075</td>
      <td>0.189518</td>
      <td>0.357601</td>
      <td>1.983686</td>
      <td>0.127660</td>
      <td>0.257074</td>
      <td>0.708155</td>
      <td>0.636170</td>
      <td>0.036145</td>
      <td>0.993976</td>
      <td>-64.239938</td>
      <td>98.368582</td>
      <td>0.766551</td>
    </tr>
    <tr>
      <th>11</th>
      <td>12</td>
      <td>0.600000</td>
      <td>0.119706</td>
      <td>0.060896</td>
      <td>1.666667</td>
      <td>0.021739</td>
      <td>0.148143</td>
      <td>0.594982</td>
      <td>0.555707</td>
      <td>0.006024</td>
      <td>1.000000</td>
      <td>-93.910424</td>
      <td>66.666667</td>
      <td>0.622074</td>
    </tr>
    <tr>
      <th>12</th>
      <td>13</td>
      <td>0.698925</td>
      <td>0.083724</td>
      <td>0.000000</td>
      <td>1.430769</td>
      <td>0.000000</td>
      <td>0.101152</td>
      <td>0.510769</td>
      <td>0.491370</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>-100.000000</td>
      <td>43.076923</td>
      <td>0.468227</td>
    </tr>
    <tr>
      <th>13</th>
      <td>14</td>
      <td>0.800000</td>
      <td>0.053134</td>
      <td>0.000000</td>
      <td>1.250000</td>
      <td>0.000000</td>
      <td>0.067558</td>
      <td>0.446237</td>
      <td>0.437824</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>-100.000000</td>
      <td>25.000000</td>
      <td>0.311037</td>
    </tr>
    <tr>
      <th>14</th>
      <td>15</td>
      <td>0.898925</td>
      <td>0.034204</td>
      <td>0.000000</td>
      <td>1.112440</td>
      <td>0.000000</td>
      <td>0.042448</td>
      <td>0.397129</td>
      <td>0.394313</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>-100.000000</td>
      <td>11.244019</td>
      <td>0.157191</td>
    </tr>
    <tr>
      <th>15</th>
      <td>16</td>
      <td>1.000000</td>
      <td>0.018713</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>0.026483</td>
      <td>0.356989</td>
      <td>0.357135</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>-100.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Scoring History: 
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>timestamp</th>
      <th>duration</th>
      <th>number_of_trees</th>
      <th>training_rmse</th>
      <th>training_logloss</th>
      <th>training_auc</th>
      <th>training_pr_auc</th>
      <th>training_lift</th>
      <th>training_classification_error</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td></td>
      <td>2020-11-07 20:03:31</td>
      <td>0.002 sec</td>
      <td>0.0</td>
      <td>0.479112</td>
      <td>0.651666</td>
      <td>0.500000</td>
      <td>0.356989</td>
      <td>1.000000</td>
      <td>0.643011</td>
    </tr>
    <tr>
      <th>1</th>
      <td></td>
      <td>2020-11-07 20:03:31</td>
      <td>0.050 sec</td>
      <td>1.0</td>
      <td>0.456602</td>
      <td>0.606210</td>
      <td>0.899111</td>
      <td>0.841991</td>
      <td>2.801205</td>
      <td>0.178495</td>
    </tr>
    <tr>
      <th>2</th>
      <td></td>
      <td>2020-11-07 20:03:31</td>
      <td>0.084 sec</td>
      <td>2.0</td>
      <td>0.437174</td>
      <td>0.568855</td>
      <td>0.918050</td>
      <td>0.868180</td>
      <td>2.801205</td>
      <td>0.154839</td>
    </tr>
    <tr>
      <th>3</th>
      <td></td>
      <td>2020-11-07 20:03:31</td>
      <td>0.115 sec</td>
      <td>3.0</td>
      <td>0.420575</td>
      <td>0.537898</td>
      <td>0.919994</td>
      <td>0.870297</td>
      <td>2.801205</td>
      <td>0.156989</td>
    </tr>
    <tr>
      <th>4</th>
      <td></td>
      <td>2020-11-07 20:03:31</td>
      <td>0.141 sec</td>
      <td>4.0</td>
      <td>0.405987</td>
      <td>0.511169</td>
      <td>0.925938</td>
      <td>0.881996</td>
      <td>2.801205</td>
      <td>0.148387</td>
    </tr>
    <tr>
      <th>5</th>
      <td></td>
      <td>2020-11-07 20:03:31</td>
      <td>0.160 sec</td>
      <td>5.0</td>
      <td>0.392586</td>
      <td>0.486722</td>
      <td>0.934239</td>
      <td>0.894388</td>
      <td>2.801205</td>
      <td>0.141935</td>
    </tr>
    <tr>
      <th>6</th>
      <td></td>
      <td>2020-11-07 20:03:31</td>
      <td>0.173 sec</td>
      <td>6.0</td>
      <td>0.380476</td>
      <td>0.464792</td>
      <td>0.937936</td>
      <td>0.899843</td>
      <td>2.801205</td>
      <td>0.141935</td>
    </tr>
    <tr>
      <th>7</th>
      <td></td>
      <td>2020-11-07 20:03:31</td>
      <td>0.188 sec</td>
      <td>7.0</td>
      <td>0.370456</td>
      <td>0.446541</td>
      <td>0.939205</td>
      <td>0.901852</td>
      <td>2.801205</td>
      <td>0.139785</td>
    </tr>
    <tr>
      <th>8</th>
      <td></td>
      <td>2020-11-07 20:03:31</td>
      <td>0.207 sec</td>
      <td>8.0</td>
      <td>0.362031</td>
      <td>0.431383</td>
      <td>0.942207</td>
      <td>0.906607</td>
      <td>2.801205</td>
      <td>0.133333</td>
    </tr>
    <tr>
      <th>9</th>
      <td></td>
      <td>2020-11-07 20:03:31</td>
      <td>0.227 sec</td>
      <td>9.0</td>
      <td>0.355361</td>
      <td>0.418882</td>
      <td>0.941834</td>
      <td>0.907237</td>
      <td>2.801205</td>
      <td>0.133333</td>
    </tr>
    <tr>
      <th>10</th>
      <td></td>
      <td>2020-11-07 20:03:31</td>
      <td>0.249 sec</td>
      <td>10.0</td>
      <td>0.346859</td>
      <td>0.403572</td>
      <td>0.945400</td>
      <td>0.914144</td>
      <td>2.801205</td>
      <td>0.144086</td>
    </tr>
    <tr>
      <th>11</th>
      <td></td>
      <td>2020-11-07 20:03:31</td>
      <td>0.264 sec</td>
      <td>11.0</td>
      <td>0.340863</td>
      <td>0.392730</td>
      <td>0.947445</td>
      <td>0.918139</td>
      <td>2.801205</td>
      <td>0.133333</td>
    </tr>
    <tr>
      <th>12</th>
      <td></td>
      <td>2020-11-07 20:03:31</td>
      <td>0.278 sec</td>
      <td>12.0</td>
      <td>0.335607</td>
      <td>0.382817</td>
      <td>0.949037</td>
      <td>0.920373</td>
      <td>2.801205</td>
      <td>0.131183</td>
    </tr>
    <tr>
      <th>13</th>
      <td></td>
      <td>2020-11-07 20:03:31</td>
      <td>0.294 sec</td>
      <td>13.0</td>
      <td>0.329409</td>
      <td>0.371826</td>
      <td>0.951445</td>
      <td>0.924512</td>
      <td>2.801205</td>
      <td>0.144086</td>
    </tr>
    <tr>
      <th>14</th>
      <td></td>
      <td>2020-11-07 20:03:31</td>
      <td>0.313 sec</td>
      <td>14.0</td>
      <td>0.324769</td>
      <td>0.363182</td>
      <td>0.952946</td>
      <td>0.927135</td>
      <td>2.801205</td>
      <td>0.133333</td>
    </tr>
    <tr>
      <th>15</th>
      <td></td>
      <td>2020-11-07 20:03:31</td>
      <td>0.331 sec</td>
      <td>15.0</td>
      <td>0.320250</td>
      <td>0.354856</td>
      <td>0.954527</td>
      <td>0.929900</td>
      <td>2.801205</td>
      <td>0.122581</td>
    </tr>
    <tr>
      <th>16</th>
      <td></td>
      <td>2020-11-07 20:03:31</td>
      <td>0.349 sec</td>
      <td>16.0</td>
      <td>0.315399</td>
      <td>0.346112</td>
      <td>0.956361</td>
      <td>0.933066</td>
      <td>2.801205</td>
      <td>0.111828</td>
    </tr>
    <tr>
      <th>17</th>
      <td></td>
      <td>2020-11-07 20:03:31</td>
      <td>0.365 sec</td>
      <td>17.0</td>
      <td>0.310275</td>
      <td>0.337092</td>
      <td>0.958123</td>
      <td>0.935908</td>
      <td>2.801205</td>
      <td>0.105376</td>
    </tr>
    <tr>
      <th>18</th>
      <td></td>
      <td>2020-11-07 20:03:31</td>
      <td>0.384 sec</td>
      <td>18.0</td>
      <td>0.305461</td>
      <td>0.328962</td>
      <td>0.960440</td>
      <td>0.939669</td>
      <td>2.801205</td>
      <td>0.103226</td>
    </tr>
    <tr>
      <th>19</th>
      <td></td>
      <td>2020-11-07 20:03:31</td>
      <td>0.399 sec</td>
      <td>19.0</td>
      <td>0.301918</td>
      <td>0.322548</td>
      <td>0.961428</td>
      <td>0.941032</td>
      <td>2.801205</td>
      <td>0.103226</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>See the whole table with table.as_data_frame()

Variable Importances: 
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>variable</th>
      <th>relative_importance</th>
      <th>scaled_importance</th>
      <th>percentage</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Glucose</td>
      <td>160.889725</td>
      <td>1.000000</td>
      <td>0.386115</td>
    </tr>
    <tr>
      <th>1</th>
      <td>BMI</td>
      <td>107.157028</td>
      <td>0.666028</td>
      <td>0.257163</td>
    </tr>
    <tr>
      <th>2</th>
      <td>DiabetesPedigreeFunction</td>
      <td>49.382526</td>
      <td>0.306934</td>
      <td>0.118512</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Age</td>
      <td>28.789474</td>
      <td>0.178939</td>
      <td>0.069091</td>
    </tr>
    <tr>
      <th>4</th>
      <td>BloodPressure</td>
      <td>24.516136</td>
      <td>0.152379</td>
      <td>0.058836</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Pregnancies</td>
      <td>22.055462</td>
      <td>0.137084</td>
      <td>0.052930</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Insulin</td>
      <td>12.949581</td>
      <td>0.080487</td>
      <td>0.031077</td>
    </tr>
    <tr>
      <th>7</th>
      <td>SkinThickness</td>
      <td>10.949017</td>
      <td>0.068053</td>
      <td>0.026276</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">perf</span> <span class="o">=</span> <span class="n">gbm</span><span class="o">.</span><span class="n">model_performance</span><span class="p">(</span><span class="n">valid</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">perf</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ModelMetricsBinomial: gbm
** Reported on test data. **

MSE: 0.18115330538099383
RMSE: 0.4256210819273334
LogLoss: 0.5366686568411096
Mean Per-Class Error: 0.25621588841722254
AUC: 0.804932282191227
AUCPR: 0.6470306042290592
Gini: 0.6098645643824541

Confusion Matrix (Act/Pred) for max f1 @ threshold = 0.1458393490707833: 
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>Error</th>
      <th>Rate</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>53.0</td>
      <td>44.0</td>
      <td>0.4536</td>
      <td>(44.0/97.0)</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>3.0</td>
      <td>48.0</td>
      <td>0.0588</td>
      <td>(3.0/51.0)</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Total</td>
      <td>56.0</td>
      <td>92.0</td>
      <td>0.3176</td>
      <td>(47.0/148.0)</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Maximum Metrics: Maximum metrics at their respective thresholds
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>metric</th>
      <th>threshold</th>
      <th>value</th>
      <th>idx</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>max f1</td>
      <td>0.145839</td>
      <td>0.671329</td>
      <td>91.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>max f2</td>
      <td>0.112531</td>
      <td>0.819936</td>
      <td>106.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>max f0point5</td>
      <td>0.668426</td>
      <td>0.642458</td>
      <td>31.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>max accuracy</td>
      <td>0.668426</td>
      <td>0.750000</td>
      <td>31.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>max precision</td>
      <td>0.980739</td>
      <td>1.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>max recall</td>
      <td>0.112531</td>
      <td>1.000000</td>
      <td>106.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>max specificity</td>
      <td>0.980739</td>
      <td>1.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>max absolute_mcc</td>
      <td>0.145839</td>
      <td>0.477769</td>
      <td>91.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>max min_per_class_accuracy</td>
      <td>0.328581</td>
      <td>0.686275</td>
      <td>64.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>max mean_per_class_accuracy</td>
      <td>0.145839</td>
      <td>0.743784</td>
      <td>91.0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>max tns</td>
      <td>0.980739</td>
      <td>97.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>max fns</td>
      <td>0.980739</td>
      <td>50.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>max fps</td>
      <td>0.019964</td>
      <td>97.000000</td>
      <td>147.0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>max tps</td>
      <td>0.112531</td>
      <td>51.000000</td>
      <td>106.0</td>
    </tr>
    <tr>
      <th>14</th>
      <td>max tnr</td>
      <td>0.980739</td>
      <td>1.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>15</th>
      <td>max fnr</td>
      <td>0.980739</td>
      <td>0.980392</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>16</th>
      <td>max fpr</td>
      <td>0.019964</td>
      <td>1.000000</td>
      <td>147.0</td>
    </tr>
    <tr>
      <th>17</th>
      <td>max tpr</td>
      <td>0.112531</td>
      <td>1.000000</td>
      <td>106.0</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Gains/Lift Table: Avg response rate: 34.46 %, avg score: 36.45 %
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>group</th>
      <th>cumulative_data_fraction</th>
      <th>lower_threshold</th>
      <th>lift</th>
      <th>cumulative_lift</th>
      <th>response_rate</th>
      <th>score</th>
      <th>cumulative_response_rate</th>
      <th>cumulative_score</th>
      <th>capture_rate</th>
      <th>cumulative_capture_rate</th>
      <th>gain</th>
      <th>cumulative_gain</th>
      <th>kolmogorov_smirnov</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0.013514</td>
      <td>0.973098</td>
      <td>1.450980</td>
      <td>1.450980</td>
      <td>0.500000</td>
      <td>0.977228</td>
      <td>0.500000</td>
      <td>0.977228</td>
      <td>0.019608</td>
      <td>0.019608</td>
      <td>45.098039</td>
      <td>45.098039</td>
      <td>0.009299</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>0.020270</td>
      <td>0.966872</td>
      <td>2.901961</td>
      <td>1.934641</td>
      <td>1.000000</td>
      <td>0.972400</td>
      <td>0.666667</td>
      <td>0.975618</td>
      <td>0.019608</td>
      <td>0.039216</td>
      <td>190.196078</td>
      <td>93.464052</td>
      <td>0.028906</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>0.033784</td>
      <td>0.952356</td>
      <td>2.901961</td>
      <td>2.321569</td>
      <td>1.000000</td>
      <td>0.963776</td>
      <td>0.800000</td>
      <td>0.970881</td>
      <td>0.039216</td>
      <td>0.078431</td>
      <td>190.196078</td>
      <td>132.156863</td>
      <td>0.068122</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>0.040541</td>
      <td>0.927994</td>
      <td>2.901961</td>
      <td>2.418301</td>
      <td>1.000000</td>
      <td>0.939870</td>
      <td>0.833333</td>
      <td>0.965713</td>
      <td>0.019608</td>
      <td>0.098039</td>
      <td>190.196078</td>
      <td>141.830065</td>
      <td>0.087730</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>0.054054</td>
      <td>0.923162</td>
      <td>1.450980</td>
      <td>2.176471</td>
      <td>0.500000</td>
      <td>0.925415</td>
      <td>0.750000</td>
      <td>0.955638</td>
      <td>0.019608</td>
      <td>0.117647</td>
      <td>45.098039</td>
      <td>117.647059</td>
      <td>0.097029</td>
    </tr>
    <tr>
      <th>5</th>
      <td>6</td>
      <td>0.101351</td>
      <td>0.892244</td>
      <td>2.072829</td>
      <td>2.128105</td>
      <td>0.714286</td>
      <td>0.906349</td>
      <td>0.733333</td>
      <td>0.932637</td>
      <td>0.098039</td>
      <td>0.215686</td>
      <td>107.282913</td>
      <td>112.810458</td>
      <td>0.174449</td>
    </tr>
    <tr>
      <th>6</th>
      <td>7</td>
      <td>0.155405</td>
      <td>0.836001</td>
      <td>2.176471</td>
      <td>2.144928</td>
      <td>0.750000</td>
      <td>0.861825</td>
      <td>0.739130</td>
      <td>0.908006</td>
      <td>0.117647</td>
      <td>0.333333</td>
      <td>117.647059</td>
      <td>114.492754</td>
      <td>0.271478</td>
    </tr>
    <tr>
      <th>7</th>
      <td>8</td>
      <td>0.202703</td>
      <td>0.722515</td>
      <td>1.658263</td>
      <td>2.031373</td>
      <td>0.571429</td>
      <td>0.773092</td>
      <td>0.700000</td>
      <td>0.876527</td>
      <td>0.078431</td>
      <td>0.411765</td>
      <td>65.826331</td>
      <td>103.137255</td>
      <td>0.318981</td>
    </tr>
    <tr>
      <th>8</th>
      <td>9</td>
      <td>0.304054</td>
      <td>0.517149</td>
      <td>1.547712</td>
      <td>1.870153</td>
      <td>0.533333</td>
      <td>0.605657</td>
      <td>0.644444</td>
      <td>0.786237</td>
      <td>0.156863</td>
      <td>0.568627</td>
      <td>54.771242</td>
      <td>87.015251</td>
      <td>0.403679</td>
    </tr>
    <tr>
      <th>9</th>
      <td>10</td>
      <td>0.398649</td>
      <td>0.409838</td>
      <td>1.036415</td>
      <td>1.672316</td>
      <td>0.357143</td>
      <td>0.461534</td>
      <td>0.576271</td>
      <td>0.709188</td>
      <td>0.098039</td>
      <td>0.666667</td>
      <td>3.641457</td>
      <td>67.231638</td>
      <td>0.408935</td>
    </tr>
    <tr>
      <th>10</th>
      <td>11</td>
      <td>0.500000</td>
      <td>0.255816</td>
      <td>0.967320</td>
      <td>1.529412</td>
      <td>0.333333</td>
      <td>0.314072</td>
      <td>0.527027</td>
      <td>0.629097</td>
      <td>0.098039</td>
      <td>0.764706</td>
      <td>-3.267974</td>
      <td>52.941176</td>
      <td>0.403881</td>
    </tr>
    <tr>
      <th>11</th>
      <td>12</td>
      <td>0.601351</td>
      <td>0.146848</td>
      <td>1.354248</td>
      <td>1.499890</td>
      <td>0.466667</td>
      <td>0.196076</td>
      <td>0.516854</td>
      <td>0.556116</td>
      <td>0.137255</td>
      <td>0.901961</td>
      <td>35.424837</td>
      <td>49.988984</td>
      <td>0.458662</td>
    </tr>
    <tr>
      <th>12</th>
      <td>13</td>
      <td>0.695946</td>
      <td>0.115818</td>
      <td>0.621849</td>
      <td>1.380544</td>
      <td>0.214286</td>
      <td>0.134532</td>
      <td>0.475728</td>
      <td>0.498813</td>
      <td>0.058824</td>
      <td>0.960784</td>
      <td>-37.815126</td>
      <td>38.054445</td>
      <td>0.404083</td>
    </tr>
    <tr>
      <th>13</th>
      <td>14</td>
      <td>0.797297</td>
      <td>0.062397</td>
      <td>0.386928</td>
      <td>1.254237</td>
      <td>0.133333</td>
      <td>0.091193</td>
      <td>0.432203</td>
      <td>0.446997</td>
      <td>0.039216</td>
      <td>1.000000</td>
      <td>-61.307190</td>
      <td>25.423729</td>
      <td>0.309278</td>
    </tr>
    <tr>
      <th>14</th>
      <td>15</td>
      <td>0.898649</td>
      <td>0.039886</td>
      <td>0.000000</td>
      <td>1.112782</td>
      <td>0.000000</td>
      <td>0.049685</td>
      <td>0.383459</td>
      <td>0.402188</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>-100.000000</td>
      <td>11.278195</td>
      <td>0.154639</td>
    </tr>
    <tr>
      <th>15</th>
      <td>16</td>
      <td>1.000000</td>
      <td>0.019964</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>0.030207</td>
      <td>0.344595</td>
      <td>0.364487</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>-100.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gbm_tune</span> <span class="o">=</span> <span class="n">H2OGradientBoostingEstimator</span><span class="p">(</span>
    <span class="n">ntrees</span> <span class="o">=</span> <span class="mi">3000</span><span class="p">,</span>
    <span class="n">learn_rate</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">,</span>
    <span class="n">stopping_rounds</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span>
    <span class="n">stopping_metric</span> <span class="o">=</span> <span class="s2">&quot;AUC&quot;</span><span class="p">,</span>
    <span class="n">col_sample_rate</span> <span class="o">=</span> <span class="mf">0.7</span><span class="p">,</span>
    <span class="n">sample_rate</span> <span class="o">=</span> <span class="mf">0.7</span><span class="p">,</span>
    <span class="n">seed</span> <span class="o">=</span> <span class="mi">1234</span>
<span class="p">)</span>      
<span class="n">gbm_tune</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">predictors</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">response</span><span class="p">,</span> <span class="n">training_frame</span><span class="o">=</span><span class="n">train</span><span class="p">,</span> <span class="n">validation_frame</span><span class="o">=</span><span class="n">valid</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>gbm Model Build progress: |███████████████████████████████████████████████| 100%
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gbm_tune</span><span class="o">.</span><span class="n">model_performance</span><span class="p">(</span><span class="n">valid</span><span class="p">)</span><span class="o">.</span><span class="n">auc</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.8019001414998989
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">h2o.grid.grid_search</span> <span class="kn">import</span> <span class="n">H2OGridSearch</span>

<span class="n">gbm_grid</span> <span class="o">=</span> <span class="n">H2OGradientBoostingEstimator</span><span class="p">(</span>
    <span class="n">ntrees</span> <span class="o">=</span> <span class="mi">3000</span><span class="p">,</span>
    <span class="n">learn_rate</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">,</span>
    <span class="n">stopping_rounds</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span>
    <span class="n">stopping_metric</span> <span class="o">=</span> <span class="s2">&quot;AUC&quot;</span><span class="p">,</span>
    <span class="n">col_sample_rate</span> <span class="o">=</span> <span class="mf">0.7</span><span class="p">,</span>
    <span class="n">sample_rate</span> <span class="o">=</span> <span class="mf">0.7</span><span class="p">,</span>
    <span class="n">seed</span> <span class="o">=</span> <span class="mi">1234</span>
<span class="p">)</span> 

<span class="n">hyper_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;max_depth&#39;</span><span class="p">:[</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">12</span><span class="p">]}</span>
<span class="n">grid</span> <span class="o">=</span> <span class="n">H2OGridSearch</span><span class="p">(</span><span class="n">gbm_grid</span><span class="p">,</span> <span class="n">hyper_params</span><span class="p">,</span>
                         <span class="n">grid_id</span><span class="o">=</span><span class="s1">&#39;depth_grid&#39;</span><span class="p">,</span>
                         <span class="n">search_criteria</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;strategy&#39;</span><span class="p">:</span> <span class="s2">&quot;Cartesian&quot;</span><span class="p">})</span>
<span class="c1">#Train grid search</span>
<span class="n">grid</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">predictors</span><span class="p">,</span> 
           <span class="n">y</span><span class="o">=</span><span class="n">response</span><span class="p">,</span>
           <span class="n">training_frame</span><span class="o">=</span><span class="n">train</span><span class="p">,</span>
           <span class="n">validation_frame</span><span class="o">=</span><span class="n">valid</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>gbm Grid Build progress: |████████████████████████████████████████████████| 100%
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    max_depth           model_ids             logloss
0          10  depth_grid_model_4  0.5610332739005056
1          12  depth_grid_model_5  0.5610431620153586
2           8  depth_grid_model_3  0.5618675574114658
3           6  depth_grid_model_2  0.5688369200105283
4           4  depth_grid_model_1  0.5720338350452505
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sorted_grid</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">get_grid</span><span class="p">(</span><span class="n">sort_by</span><span class="o">=</span><span class="s1">&#39;auc&#39;</span><span class="p">,</span><span class="n">decreasing</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sorted_grid</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    max_depth           model_ids                 auc
0          10  depth_grid_model_4  0.8067515666060238
1          12  depth_grid_model_5  0.8067515666060238
2           8  depth_grid_model_3  0.8033151404891854
3           6  depth_grid_model_2  0.8031129977764302
4           4  depth_grid_model_1  0.7984637153830605
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cv_gbm</span> <span class="o">=</span> <span class="n">H2OGradientBoostingEstimator</span><span class="p">(</span>
    <span class="n">ntrees</span> <span class="o">=</span> <span class="mi">3000</span><span class="p">,</span>
    <span class="n">learn_rate</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span>
    <span class="n">stopping_rounds</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span>
    <span class="n">stopping_metric</span> <span class="o">=</span> <span class="s2">&quot;AUC&quot;</span><span class="p">,</span>
    <span class="n">nfolds</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> 
    <span class="n">seed</span><span class="o">=</span><span class="mi">2018</span><span class="p">)</span>
<span class="n">cv_gbm</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">predictors</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">response</span><span class="p">,</span> <span class="n">training_frame</span> <span class="o">=</span> <span class="n">train</span><span class="p">,</span> <span class="n">validation_frame</span><span class="o">=</span><span class="n">valid</span><span class="p">)</span>
<span class="n">cv_summary</span> <span class="o">=</span> <span class="n">cv_gbm</span><span class="o">.</span><span class="n">cross_validation_metrics_summary</span><span class="p">()</span><span class="o">.</span><span class="n">as_data_frame</span><span class="p">()</span>
<span class="n">cv_summary</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>gbm Model Build progress: |███████████████████████████████████████████████| 100%
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>mean</th>
      <th>sd</th>
      <th>cv_1_valid</th>
      <th>cv_2_valid</th>
      <th>cv_3_valid</th>
      <th>cv_4_valid</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>accuracy</td>
      <td>0.8060614</td>
      <td>0.028866975</td>
      <td>0.81512606</td>
      <td>0.84166664</td>
      <td>0.775</td>
      <td>0.7924528</td>
    </tr>
    <tr>
      <th>1</th>
      <td>auc</td>
      <td>0.83460003</td>
      <td>0.0253348</td>
      <td>0.8711854</td>
      <td>0.82493657</td>
      <td>0.81303704</td>
      <td>0.8292411</td>
    </tr>
    <tr>
      <th>2</th>
      <td>aucpr</td>
      <td>0.7332863</td>
      <td>0.08590643</td>
      <td>0.77500844</td>
      <td>0.60952866</td>
      <td>0.7449944</td>
      <td>0.8036139</td>
    </tr>
    <tr>
      <th>3</th>
      <td>err</td>
      <td>0.19393861</td>
      <td>0.028866975</td>
      <td>0.18487395</td>
      <td>0.15833333</td>
      <td>0.225</td>
      <td>0.20754717</td>
    </tr>
    <tr>
      <th>4</th>
      <td>err_count</td>
      <td>22.5</td>
      <td>3.3166249</td>
      <td>22.0</td>
      <td>19.0</td>
      <td>27.0</td>
      <td>22.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>f0point5</td>
      <td>0.7166275</td>
      <td>0.023856336</td>
      <td>0.7432432</td>
      <td>0.6993007</td>
      <td>0.6938776</td>
      <td>0.7300885</td>
    </tr>
    <tr>
      <th>6</th>
      <td>f1</td>
      <td>0.7359389</td>
      <td>0.051860016</td>
      <td>0.8</td>
      <td>0.6779661</td>
      <td>0.7157895</td>
      <td>0.75</td>
    </tr>
    <tr>
      <th>7</th>
      <td>f2</td>
      <td>0.75854874</td>
      <td>0.086101264</td>
      <td>0.86614174</td>
      <td>0.65789473</td>
      <td>0.73913044</td>
      <td>0.77102804</td>
    </tr>
    <tr>
      <th>8</th>
      <td>lift_top_group</td>
      <td>2.0913858</td>
      <td>0.6500798</td>
      <td>1.2395834</td>
      <td>1.9354838</td>
      <td>2.6666667</td>
      <td>2.5238094</td>
    </tr>
    <tr>
      <th>9</th>
      <td>logloss</td>
      <td>0.4842181</td>
      <td>0.03085123</td>
      <td>0.46077308</td>
      <td>0.45635447</td>
      <td>0.52019364</td>
      <td>0.49955118</td>
    </tr>
    <tr>
      <th>10</th>
      <td>max_per_class_error</td>
      <td>0.2667725</td>
      <td>0.061059155</td>
      <td>0.2535211</td>
      <td>0.3548387</td>
      <td>0.24444444</td>
      <td>0.21428572</td>
    </tr>
    <tr>
      <th>11</th>
      <td>mcc</td>
      <td>0.58331674</td>
      <td>0.049473092</td>
      <td>0.65121645</td>
      <td>0.5746587</td>
      <td>0.5324516</td>
      <td>0.5749401</td>
    </tr>
    <tr>
      <th>12</th>
      <td>mean_per_class_accuracy</td>
      <td>0.79290384</td>
      <td>0.027116295</td>
      <td>0.8315728</td>
      <td>0.7776368</td>
      <td>0.77111113</td>
      <td>0.79129463</td>
    </tr>
    <tr>
      <th>13</th>
      <td>mean_per_class_error</td>
      <td>0.20709616</td>
      <td>0.027116295</td>
      <td>0.16842723</td>
      <td>0.22236317</td>
      <td>0.22888888</td>
      <td>0.20870535</td>
    </tr>
    <tr>
      <th>14</th>
      <td>mse</td>
      <td>0.1554569</td>
      <td>0.008760154</td>
      <td>0.14931631</td>
      <td>0.14733355</td>
      <td>0.16610987</td>
      <td>0.1590679</td>
    </tr>
    <tr>
      <th>15</th>
      <td>pr_auc</td>
      <td>0.7332863</td>
      <td>0.08590643</td>
      <td>0.77500844</td>
      <td>0.60952866</td>
      <td>0.7449944</td>
      <td>0.8036139</td>
    </tr>
    <tr>
      <th>16</th>
      <td>precision</td>
      <td>0.7053386</td>
      <td>0.017187094</td>
      <td>0.7096774</td>
      <td>0.71428573</td>
      <td>0.68</td>
      <td>0.7173913</td>
    </tr>
    <tr>
      <th>17</th>
      <td>r2</td>
      <td>0.30923334</td>
      <td>0.06338601</td>
      <td>0.37955743</td>
      <td>0.23102464</td>
      <td>0.29126453</td>
      <td>0.33508673</td>
    </tr>
    <tr>
      <th>18</th>
      <td>recall</td>
      <td>0.7757745</td>
      <td>0.11168112</td>
      <td>0.9166667</td>
      <td>0.6451613</td>
      <td>0.75555557</td>
      <td>0.78571427</td>
    </tr>
    <tr>
      <th>19</th>
      <td>rmse</td>
      <td>0.39416355</td>
      <td>0.011076028</td>
      <td>0.38641468</td>
      <td>0.38384053</td>
      <td>0.4075658</td>
      <td>0.39883316</td>
    </tr>
    <tr>
      <th>20</th>
      <td>specificity</td>
      <td>0.8100332</td>
      <td>0.070176266</td>
      <td>0.74647886</td>
      <td>0.9101124</td>
      <td>0.7866667</td>
      <td>0.796875</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cv_gbm</span><span class="o">.</span><span class="n">model_performance</span><span class="p">(</span><span class="n">valid</span><span class="p">)</span><span class="o">.</span><span class="n">auc</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.8059429957550029
</pre></div>
</div>
</div>
</div>
<p><strong>XGBoost:</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">h2o.estimators</span> <span class="kn">import</span> <span class="n">H2OXGBoostEstimator</span>

<span class="n">cv_xgb</span> <span class="o">=</span> <span class="n">H2OXGBoostEstimator</span><span class="p">(</span>
    <span class="n">ntrees</span> <span class="o">=</span> <span class="mi">3000</span><span class="p">,</span>
    <span class="n">learn_rate</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span>
    <span class="n">stopping_rounds</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span>
    <span class="n">stopping_metric</span> <span class="o">=</span> <span class="s2">&quot;AUC&quot;</span><span class="p">,</span>
    <span class="n">nfolds</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> 
    <span class="n">seed</span><span class="o">=</span><span class="mi">2018</span><span class="p">)</span>
<span class="n">cv_xgb</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">predictors</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">response</span><span class="p">,</span> <span class="n">training_frame</span> <span class="o">=</span> <span class="n">train</span><span class="p">,</span> <span class="n">validation_frame</span><span class="o">=</span><span class="n">valid</span><span class="p">)</span>
<span class="n">cv_xgb</span><span class="o">.</span><span class="n">model_performance</span><span class="p">(</span><span class="n">valid</span><span class="p">)</span><span class="o">.</span><span class="n">auc</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>xgboost Model Build progress: |███████████████████████████████████████████| 100%
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.7982615726703053
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cv_xgb</span><span class="o">.</span><span class="n">varimp_plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/2020-11-17-diab_prediction_with_h2o_25_0.png" src="_images/2020-11-17-diab_prediction_with_h2o_25_0.png" />
</div>
</div>
<p><strong>AutoML : Automatic Machine Learning:</strong></p>
<p>From the <a class="reference external" href="http://docs.h2o.ai/h2o/latest-stable/h2o-docs/automl.html">H2O AutoML page</a>,</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">h2o.automl</span> <span class="kn">import</span> <span class="n">H2OAutoML</span>

<span class="n">aml</span> <span class="o">=</span> <span class="n">H2OAutoML</span><span class="p">(</span><span class="n">max_models</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">max_runtime_secs</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">aml</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">predictors</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">response</span><span class="p">,</span> <span class="n">training_frame</span><span class="o">=</span><span class="n">train</span><span class="p">,</span> <span class="n">validation_frame</span><span class="o">=</span><span class="n">valid</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>AutoML progress: |
20:03:54.196: User specified a validation frame with cross-validation still enabled. Please note that the models will still be validated using cross-validation only, the validation frame will be used to provide purely informative validation metrics on the trained models.

████████████████████████████████████████████████████████| 100%
</pre></div>
</div>
</div>
</div>
<p>automl leaderboard:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lb</span> <span class="o">=</span> <span class="n">aml</span><span class="o">.</span><span class="n">leaderboard</span>
<span class="n">lb</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table>
<thead>
<tr><th>model_id                                           </th><th style="text-align: right;">     auc</th><th style="text-align: right;">  logloss</th><th style="text-align: right;">   aucpr</th><th style="text-align: right;">  mean_per_class_error</th><th style="text-align: right;">    rmse</th><th style="text-align: right;">     mse</th></tr>
</thead>
<tbody>
<tr><td>StackedEnsemble_BestOfFamily_AutoML_20201107_200354</td><td style="text-align: right;">0.838498</td><td style="text-align: right;"> 0.471209</td><td style="text-align: right;">0.720251</td><td style="text-align: right;">              0.225168</td><td style="text-align: right;">0.389759</td><td style="text-align: right;">0.151912</td></tr>
<tr><td>DRF_1_AutoML_20201107_200354                       </td><td style="text-align: right;">0.837813</td><td style="text-align: right;"> 0.673743</td><td style="text-align: right;">0.750599</td><td style="text-align: right;">              0.225158</td><td style="text-align: right;">0.390594</td><td style="text-align: right;">0.152563</td></tr>
<tr><td>StackedEnsemble_AllModels_AutoML_20201107_200354   </td><td style="text-align: right;">0.836755</td><td style="text-align: right;"> 0.473849</td><td style="text-align: right;">0.717937</td><td style="text-align: right;">              0.233197</td><td style="text-align: right;">0.391309</td><td style="text-align: right;">0.153122</td></tr>
<tr><td>GLM_1_AutoML_20201107_200354                       </td><td style="text-align: right;">0.831638</td><td style="text-align: right;"> 0.488798</td><td style="text-align: right;">0.716653</td><td style="text-align: right;">              0.238204</td><td style="text-align: right;">0.395915</td><td style="text-align: right;">0.156749</td></tr>
<tr><td>GBM_2_AutoML_20201107_200354                       </td><td style="text-align: right;">0.823921</td><td style="text-align: right;"> 0.492342</td><td style="text-align: right;">0.730483</td><td style="text-align: right;">              0.240198</td><td style="text-align: right;">0.397899</td><td style="text-align: right;">0.158323</td></tr>
<tr><td>GBM_1_AutoML_20201107_200354                       </td><td style="text-align: right;">0.823186</td><td style="text-align: right;"> 0.499362</td><td style="text-align: right;">0.730256</td><td style="text-align: right;">              0.23354 </td><td style="text-align: right;">0.398824</td><td style="text-align: right;">0.15906 </td></tr>
<tr><td>GBM_3_AutoML_20201107_200354                       </td><td style="text-align: right;">0.822944</td><td style="text-align: right;"> 0.491874</td><td style="text-align: right;">0.745621</td><td style="text-align: right;">              0.245578</td><td style="text-align: right;">0.396877</td><td style="text-align: right;">0.157511</td></tr>
<tr><td>XGBoost_2_AutoML_20201107_200354                   </td><td style="text-align: right;">0.822722</td><td style="text-align: right;"> 0.490048</td><td style="text-align: right;">0.729844</td><td style="text-align: right;">              0.237186</td><td style="text-align: right;">0.402005</td><td style="text-align: right;">0.161608</td></tr>
<tr><td>GBM_4_AutoML_20201107_200354                       </td><td style="text-align: right;">0.82235 </td><td style="text-align: right;"> 0.492086</td><td style="text-align: right;">0.726875</td><td style="text-align: right;">              0.241578</td><td style="text-align: right;">0.398974</td><td style="text-align: right;">0.159181</td></tr>
<tr><td>GBM_5_AutoML_20201107_200354                       </td><td style="text-align: right;">0.817947</td><td style="text-align: right;"> 0.496638</td><td style="text-align: right;">0.68625 </td><td style="text-align: right;">              0.239211</td><td style="text-align: right;">0.403748</td><td style="text-align: right;">0.163012</td></tr>
</tbody>
</table></div><div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">metalearner</span> <span class="o">=</span> <span class="n">h2o</span><span class="o">.</span><span class="n">get_model</span><span class="p">(</span><span class="n">aml</span><span class="o">.</span><span class="n">leader</span><span class="o">.</span><span class="n">metalearner</span><span class="p">()[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>
<span class="n">metalearner</span><span class="o">.</span><span class="n">std_coef_plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/2020-11-17-diab_prediction_with_h2o_30_0.png" src="_images/2020-11-17-diab_prediction_with_h2o_30_0.png" />
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="2020-10-06-NLP-sqlitedb.html" title="previous page">Using sqlalchemy and pandas to read and write from and to a local sqlite database for NLP</a>
    <a class='right-next' id="next-link" href="intro.html" title="next page">Hands On Data Science at Scale with PySpark, Dask and H2O.</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By David Kearney<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>